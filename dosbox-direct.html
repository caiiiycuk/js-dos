<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2024-08-28T11:13:17.1253814"><title>DOSBox Direct | js-dos</title><script type="application/json" id="virtual-toc-data">[{"id":"accessing-file-system","level":0,"title":"Accessing file system","anchor":"#accessing-file-system"},{"id":"accessing-memory","level":0,"title":"Accessing memory","anchor":"#accessing-memory"},{"id":"pausing-execution","level":0,"title":"Pausing execution","anchor":"#pausing-execution"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b408/app.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/logo-16.png"><link rel="icon" type="image/png" sizes="32x32" href="images/logo-32.png"><link rel="icon" type="image/png" sizes="96x96" href="images/logo-192.png"><link rel="icon" type="image/png" sizes="300x300" href="images/logo-512.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="DOSBox Direct | js-dos"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="js-dos Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://js-dos.com//8.xx/dosbox-direct.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="DOSBox Direct | js-dos"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "https://js-dos.com//8.xx/dosbox-direct.html#webpage",
    "url": "https://js-dos.com//8.xx/dosbox-direct.html",
    "name": "DOSBox Direct | js-dos",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "https://js-dos.com/#website",
    "url": "https://js-dos.com/",
    "name": "js-dos Help"
}</script><!-- End Schema.org --></head><body data-id="dosbox-direct" data-main-title="DOSBox Direct" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="emulators.md|emulators"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>js-dos 8.xx Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="dosbox-direct" id="dosbox-direct.md">DOSBox Direct</h1><p id="z8tnsas_3">DOS Direct is an emulation backend based on DOSBox, you can create it with the following command:</p><div class="code-block" data-lang="javascript">
const ci = await emulators.dosboxDirect(bundle);
</div><p id="z8tnsas_5">Direct version is universal, it can work in Node.js environment. But it has a strong disadvantage: it's working on the main browser thread. So it can easily the app froze a browser for some amount of time, and not be very responsive.</p><aside class="prompt" data-type="tip" data-title="" id="z8tnsas_6"><p id="z8tnsas_10"><a href="dosbox-worker.html" id="z8tnsas_11" data-tooltip="DOSBox Worker is the worker version of DOSBOX Direct backend. It runs in its own browser thread, so it's never block the browser. This version is recommended to use in most cases.">DOSBox Worker</a> is a more preferred version of the emulator backend, because it does not block the browser.</p></aside><section class="chapter"><h2 id="accessing-file-system" data-toc="accessing-file-system">Accessing file system</h2><p id="z8tnsas_12">In direct mode you can easily access emscripten module:</p><div class="code-block" data-lang="javascript">
const ci = await emulators.dosboxDirect(bundle);
ci.transport.module // &lt;-- emscripten module
</div><p id="z8tnsas_14">Emscripten module provide lowlevel api to change <a href="https://emscripten.org/docs/api_reference/Filesystem-API.html" id="z8tnsas_18" data-external="true" rel="noopener noreferrer">file system</a>:</p><div class="code-block" data-lang="javascript">
const ci = await emulators.dosboxDirect(bundle);
ci.transport.module.FS // &lt;-- emscripten FS api
</div><p id="z8tnsas_16">You can also rescan DOS devices:</p><div class="code-block" data-lang="javascript">
const ci = await emulators.dosboxDirect(bundle);
ci.transport.module._rescanFilesystem();
</div></section><section class="chapter"><h2 id="accessing-memory" data-toc="accessing-memory">Accessing memory</h2><p id="z8tnsas_19">In direct mode you can dump whole memory of dos:</p><div class="code-block" data-lang="javascript">
const ci = await emulators.dosboxDirect(bundle);
ci.transport.module._dumpMemory(copyDosMemory);
ci.transport.module.memoryContents // &lt;-- now you can access contents using this var
</div><p id="z8tnsas_21">If you need to copy the entire memory, pass <code class="code" id="z8tnsas_23">true</code> as argument. The <code class="code" id="z8tnsas_24">memoryContents</code> contains the following:</p><div class="code-block" data-lang="javascript">
{
        &quot;memBase&quot;: ...,
        &quot;ip&quot;: ...,
        &quot;flags&quot;: ...,
        &quot;registers&quot;: {
            &quot;ax&quot;: ...,
            &quot;cx&quot;: ...,
            &quot;dx&quot;: ...,
            &quot;sp&quot;: ...,
            &quot;bp&quot;: ...,
            &quot;si&quot;: ...,
            &quot;di&quot;: ...
        },
        &quot;segments_values&quot;: {
            &quot;es&quot;: ...,
            &quot;cs&quot;: ...,
            &quot;ss&quot;: ...,
            &quot;ds&quot;: ...,
            &quot;fs&quot;: ...,
            &quot;gs&quot;: ...
        },
        &quot;segments_physical&quot;: {
            &quot;es&quot;: ...,
            &quot;cs&quot;: ...,
            &quot;ss&quot;: ...,
            &quot;ds&quot;: ...,
            &quot;fs&quot;: ...,
            &quot;gs&quot;: ...
        },
        &quot;numPages&quot;: ...,
        &quot;memoryCopy&quot;: ...
}
</div></section><section class="chapter"><h2 id="pausing-execution" data-toc="pausing-execution">Pausing execution</h2><p id="z8tnsas_25">In direct mode, you can pause the Dosbox execution loop without pausing the emscripten loop. This lets you pause and inspect the current memory, for instance.</p><div class="code-block" data-lang="javascript">
const ci = await emulators.dosboxDirect(bundle);
ci.transport.module._pauseExecution(true);
</div><p id="z8tnsas_27">The <code class="code" id="z8tnsas_29">_pauseExecution</code> function takes as its argument whether it should be paused or should resume. To resume once you have completed:</p><div class="code-block" data-lang="javascript">
ci.transport.module._pauseExecution(false);
</div></section><div class="last-modified">Last modified: 28 августа 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="command-interface.html" class="navigation-links__prev">Command Interface (CI)</a><a href="dosbox-worker.html" class="navigation-links__next">DOSBox Worker</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b408/app.js"></script></body></html>